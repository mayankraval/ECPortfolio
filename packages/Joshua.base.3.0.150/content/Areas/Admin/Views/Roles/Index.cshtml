@model IEnumerable<Joshua.Models.SecurityRole>
@{
  ViewBag.Title = "Security Roles";
  Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}
<div class="container">
  <h1>Security Roles</h1>
  <p>

    <a href="javascript:NewRole()" class="btn btn-success btn-large">
      <i class="icon-plus icon-white"></i>
    </a>
  </p>

  @if (Model != null)
  {
    <table class="table table-stripped table-hover">
      <tr>
        <th>
          @Html.DisplayNameFor(model => model.Name)
        </th>
        <th>
          @Html.DisplayNameFor(model => model.Description)
        </th>
        <th style="width: 10%;"></th>
      </tr>
      @if (Model != null)
      {
        foreach (var item in Model)
        {
        <tr class="itemid-@item._Id">
          <td class="item_name">
            @Html.DisplayFor(modelItem => item.Name)
          </td>
          <td class="item_description">
            @Html.DisplayFor(modelItem => item.Description)
          </td>
          <td>
            <div class="btn-group">
              <button class="btn btn-warning" onclick="javascript:edit('@(item._Id)')"><i class="icon-pencil "></i></button>
              <button class="btn btn-danger" onclick="javascript:deleteItem('@item._Id')"><i class="icon-trash icon-white"></i></button>
            </div>
          </td>
        </tr>
        }
      }

    </table>
  }
</div>


@Html.Part_Modal("inlinecreatedialog",
                 content: Html.Partial("_Inline_Create", new Joshua.Models.SecurityRole()),
                 width: 400, showheader: true, header: "new/edit role")

@section scripts
{
  @Scripts.Render("~/bundles/jqueryval")
  <script type="text/javascript">

    function NewRole() {
      $("#inlinecreatedialog").modal({ keyboard: false });
    }

    function edit(itemid) {
      var row = $(".itemid-" + itemid);
      $("#Name").val(row.find(".item_name").html().trim());
      $("#Description").val(row.find(".item_description").html().trim());
      $("#_Id").val(itemid);

      $("#inlinecreatedialog").modal({ keyboard: false });
    }

    function deleteItem(itemid) {
      ShowModal("Warning", "the selected role will be deleted", function () {
        $.get("@Url.Content("~/Admin/Roles/Delete")/" + itemid, null, function (data) {
          if (Boolean(data)) {
            $(".itemid-" + itemid).remove();
            ShowAlert("The role has been deleted ");
          }
          else {
            ShowAlert(data);
          }
        });
      });
    }
  </script>
}
